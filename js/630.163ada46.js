"use strict";(self["webpackChunkeasy_redeem"]=self["webpackChunkeasy_redeem"]||[]).push([[630],{7630:(e,t,l)=>{l.r(t),l.d(t,{default:()=>I});var a=l(3673),s=l(2323);const d={class:"q-mb-md"},i={class:"text-h4"},o={class:"text-subtitle1"},n={class:"q-gutter-x-sm"},r={class:"text-h6"},c={class:"text-caption"},u={class:"text-caption text-black"};function p(e,t,l,p,m,b){const f=(0,a.up)("q-btn"),h=(0,a.up)("q-item-label"),w=(0,a.up)("q-item-section"),g=(0,a.up)("q-item"),$=(0,a.up)("q-list"),k=(0,a.up)("q-btn-dropdown"),C=(0,a.up)("q-table"),_=(0,a.up)("q-card-section"),v=(0,a.up)("q-input"),q=(0,a.up)("q-card-actions"),y=(0,a.up)("q-card"),S=(0,a.up)("q-dialog"),W=(0,a.up)("q-page"),Z=(0,a.Q2)("close-popup");return(0,a.wg)(),(0,a.j4)(W,{padding:""},{default:(0,a.w5)((()=>[(0,a._)("div",d,[(0,a._)("div",i,(0,s.zw)(e.$t("cards.title")),1),(0,a._)("div",o,(0,s.zw)(e.$t("cards.subtitle")),1)]),(0,a.Wm)(C,{title:e.$t("cards.table.title"),columns:m.columns,rows:m.cards,selection:"multiple",selected:m.selectedCards,"onUpdate:selected":t[4]||(t[4]=e=>m.selectedCards=e),"row-key":"pin","no-data-label":e.$t("cards.table.noData"),"rows-per-page-label":e.$t("cards.table.rowsPerPage"),"selected-rows-label":b.selectedRowsLabel,"icon-first-page":p.matFirstPage,"icon-last-page":p.matLastPage,"pagination-label":b.paginationLabel},{"top-left":(0,a.w5)((()=>[(0,a.Wm)(f,{label:e.$t("cards.table.export"),icon:p.matSystemUpdateAlt,color:"primary",outline:"","no-caps":"",onClick:b.exportTable},null,8,["label","icon","onClick"])])),"top-right":(0,a.w5)((()=>[(0,a._)("div",n,[(0,a.Wm)(f,{label:e.$t("cards.add.button"),icon:p.matAdd,color:"primary","no-caps":"",onClick:t[0]||(t[0]=e=>m.showAddDialog=!0)},null,8,["label","icon"]),(0,a.Wm)(k,{color:"primary",label:e.$t("cards.table.options"),"no-caps":"",disable:!m.selectedCards.length},{default:(0,a.w5)((()=>[(0,a.Wm)($,null,{default:(0,a.w5)((()=>[(0,a.wy)(((0,a.wg)(),(0,a.j4)(g,{clickable:"",onClick:t[1]||(t[1]=e=>b.mark("ok"))},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("cards.table.markOk")),1)])),_:1})])),_:1})])),_:1})),[[Z]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(g,{clickable:"",onClick:t[2]||(t[2]=e=>b.mark("redeemed"))},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("cards.table.markRedeemed")),1)])),_:1})])),_:1})])),_:1})),[[Z]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(g,{clickable:"",onClick:t[3]||(t[3]=e=>b.mark("invalid"))},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("cards.table.markInvalid")),1)])),_:1})])),_:1})])),_:1})),[[Z]]),(0,a.wy)(((0,a.wg)(),(0,a.j4)(g,{clickable:"",onClick:b.deleteSelected},{default:(0,a.w5)((()=>[(0,a.Wm)(w,null,{default:(0,a.w5)((()=>[(0,a.Wm)(h,null,{default:(0,a.w5)((()=>[(0,a.Uk)((0,s.zw)(e.$t("cards.table.delete")),1)])),_:1})])),_:1})])),_:1},8,["onClick"])),[[Z]])])),_:1})])),_:1},8,["label","disable"])])])),_:1},8,["title","columns","rows","selected","no-data-label","rows-per-page-label","selected-rows-label","icon-first-page","icon-last-page","pagination-label"]),(0,a.Wm)(S,{modelValue:m.showAddDialog,"onUpdate:modelValue":t[7]||(t[7]=e=>m.showAddDialog=e),persistent:""},{default:(0,a.w5)((()=>[(0,a.Wm)(y,{style:{"min-width":"350px"}},{default:(0,a.w5)((()=>[(0,a.Wm)(_,null,{default:(0,a.w5)((()=>[(0,a._)("div",r,(0,s.zw)(e.$t("cards.add.title")),1)])),_:1}),(0,a.Wm)(_,{class:"q-pt-none q-gutter-y-sm"},{default:(0,a.w5)((()=>[(0,a.Wm)(v,{filled:"",modelValue:m.cardInput,"onUpdate:modelValue":t[5]||(t[5]=e=>m.cardInput=e),label:e.$t("cards.table.title"),type:"textarea"},null,8,["modelValue","label"]),(0,a.Wm)(v,{filled:"",modelValue:m.cardValue,"onUpdate:modelValue":t[6]||(t[6]=e=>m.cardValue=e),label:e.$t("cards.table.value")},null,8,["modelValue","label"]),(0,a._)("div",c,(0,s.zw)(e.$t("cards.add.caption")),1),(0,a._)("div",u,(0,s.zw)(e.$t("cards.add.count",{count:b.filterPins(m.cardInput.split("\n")).length})),1)])),_:1}),(0,a.Wm)(q,{align:"right",class:"text-primary"},{default:(0,a.w5)((()=>[(0,a.wy)((0,a.Wm)(f,{flat:"",label:e.$t("cards.table.cancel")},null,8,["label"]),[[Z]]),(0,a.wy)((0,a.Wm)(f,{flat:"",label:e.$t("cards.add.button"),onClick:b.add},null,8,["label","onClick"]),[[Z]])])),_:1})])),_:1})])),_:1},8,["modelValue"])])),_:1})}l(5363),l(7768),l(71);var m=l(2841),b=l(6060);function f(e,t,l){let a=void 0!==t?t(e,l):e;return a=void 0===a||null===a?"":String(a),a=a.split('"').join('""'),`"${a}"`}const h={name:"Cards",setup(){return{matAdd:b.vML,matFileUpload:b.$hy,matFirstPage:b.NaY,matLastPage:b.qzL,matSystemUpdateAlt:b.hKe,matDone:b.itb}},mounted(){this.load()},data(){const e=[{name:"pin",label:this.$t("cards.table.pin"),field:"pin"},{name:"value",label:this.$t("cards.table.value"),field:"value"},{name:"status",label:this.$t("cards.table.status"),field:"status"},{name:"timeAdded",label:this.$t("cards.table.timeAdded"),field:"timeAdded"},{name:"timeUpdated",label:this.$t("cards.table.timeUpdated"),field:"timeUpdated"}];return{showAddDialog:!1,cardInput:"",cards:[],selectedCards:[],columns:e,cardValue:this.$utils.getPreference("defaultCardValue","$10")}},methods:{add(){let e=this.cardInput.replaceAll(" ","").split("\n");e=this.filterPins(e);let t=[],l=new Date;for(const s of e)t.push({pin:s,value:this.cardValue,status:"ok",timeAdded:l.toLocaleString(),timeUpdated:l.toLocaleString()});let a=this.$utils.fetchCards(this.$q.localStorage);this.$q.localStorage.set("cards",JSON.stringify(a.concat(t))),this.load(),this.$utils.notifyPositive(this.$t("cards.add.added",{count:e.length})),this.cardInput=""},filterPins(e){e=e.map((e=>e.trim())),e=e.filter((e=>e));let t=JSON.parse(this.$q.localStorage.getItem("preferences"));return t&&t.importAppleValidation&&(e=e.filter((e=>"X"===e[0]&&16===e.length))),e},load(){let e=this.$q.localStorage.getItem("cards");e&&(this.cards=JSON.parse(e).reverse())},selectedRowsLabel(e){return this.$t("cards.table.selectedRows",{records:e})},paginationLabel(e,t,l){return this.$t("cards.table.pagination",{first:e,last:t,total:l})},exportTable(){const e=[this.columns.map((e=>f(e.label)))].concat(this.cards.map((e=>this.columns.map((t=>f("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format,e))).join(",")))).join("\r\n");(0,m.Z)("table-export.csv",e,"text/csv")},mark(e){let t=this.$utils.fetchCards(this.$q.localStorage);for(const l of this.selectedCards){let a=0;for(const s of t)l.pin===s.pin&&(t[a].status=e),a++}this.$q.localStorage.set("cards",JSON.stringify(t)),this.load(),this.$utils.notifyPositive(this.$t("cards.marked",{status:e,count:this.selectedCards.length})),this.selectedCards=[]},deleteSelected(){let e=this.$utils.fetchCards(this.$q.localStorage),t=e.length;while(t--)for(const l of this.selectedCards)if(l.pin===e[t].pin){e.splice(t,1);break}this.$q.localStorage.set("cards",JSON.stringify(e)),this.load(),this.$utils.notifyPositive(this.$t("cards.deleted",{count:this.selectedCards.length})),this.selectedCards=[]}}};var w=l(4260),g=l(4379),$=l(5076),k=l(2165),C=l(2670),_=l(7011),v=l(3414),q=l(2035),y=l(2350),S=l(6778),W=l(151),Z=l(5589),x=l(4842),A=l(9367),P=l(677),U=l(7518),V=l.n(U);const Q=(0,w.Z)(h,[["render",p]]),I=Q;V()(h,"components",{QPage:g.Z,QTable:$.Z,QBtn:k.Z,QBtnDropdown:C.Z,QList:_.Z,QItem:v.Z,QItemSection:q.Z,QItemLabel:y.Z,QDialog:S.Z,QCard:W.Z,QCardSection:Z.Z,QInput:x.Z,QCardActions:A.Z}),V()(h,"directives",{ClosePopup:P.Z})}}]);